From 567205038a33bf66664a18b0b069db44880e5e83 Mon Sep 17 00:00:00 2001
From: Min RK <benjaminrk@gmail.com>
Date: Wed, 17 Mar 2021 12:52:25 +0100
Subject: [PATCH] ensure _X_SENTINEL, _X_DEPRECATED are defined

seem to not be on mac
---
 src/include/IV-X11/Xlib.h            | 8 ++++++++
 src/include/IV-X11/ivx11_declare.h   | 4 ++++
 src/include/IV-X11/ivx11_define.h    | 4 ++++
 src/lib/x11_dynam/ivx11_dynamlib.cpp | 9 +++++++++
 src/lib/x11_dynam/mkdynam.py         | 4 ++++
 5 files changed, 29 insertions(+)

diff --git a/src/oc/x.c b/iv/src/oc/x.c
index 7a80a51..7ecf7d3 100755
--- a/src/oc/x.c
+++ b/src/oc/x.c
@@ -13,6 +13,14 @@

 #if NRNOC_X11

+#ifndef _X_DEPRECATED
+#  define _X_DEPRECATED
+#endif
+
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
+
 #if defined(IVX11_DYNAM)
 #include <IV-X11/ivx11_declare.h>
 #include <IV-X11/ivx11_redef.h>

diff --git a/external/iv/src/include/IV-X11/Xlib.h b/external/iv/src/include/IV-X11/Xlib.h
index cbd7c14..eb1dcf8 100755
--- a/external/iv/src/include/IV-X11/Xlib.h
+++ b/external/iv/src/include/IV-X11/Xlib.h
@@ -49,6 +49,14 @@ struct _XPrivate;
 struct _XrmHashBucketRec;
 #endif
 
+#ifndef _X_DEPRECATED
+#  define _X_DEPRECATED
+#endif
+
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
+
 #include <IV-X11/Xdefs.h>
 #if defined(IVX11_DYNAM)
 #include <IV-X11/ivx11_declare.h>
diff --git a/external/iv/src/include/IV-X11/ivx11_declare.h b/external/iv/src/include/IV-X11/ivx11_declare.h
index 952efee..c3319fd 100644
--- a/external/iv/src/include/IV-X11/ivx11_declare.h
+++ b/external/iv/src/include/IV-X11/ivx11_declare.h
@@ -39,6 +39,10 @@ in this Software without prior written authorization from The Open Group.
 #define _X11_XLIB_H_
 #define _XLIB_H_
 
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
+
 #define XlibSpecificationRelease 6
 
 #include <sys/types.h>
diff --git a/external/iv/src/include/IV-X11/ivx11_define.h b/external/iv/src/include/IV-X11/ivx11_define.h
index 2415d1c..24bdb02 100644
--- a/external/iv/src/include/IV-X11/ivx11_define.h
+++ b/external/iv/src/include/IV-X11/ivx11_define.h
@@ -3,6 +3,10 @@
 #ifndef ivx11_define_h
 #define ivx11_define_h
 
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
+
 IVX11EXTERN int *ivdynam__Xdebug ;
 IVX11EXTERN XFontStruct * (*ivdynam_XLoadQueryFont) (
     Display*		/* display */,
diff --git a/external/iv/src/lib/x11_dynam/ivx11_dynamlib.cpp b/external/iv/src/lib/x11_dynam/ivx11_dynamlib.cpp
index fc04691..3e0a6a1 100644
--- a/external/iv/src/lib/x11_dynam/ivx11_dynamlib.cpp
+++ b/external/iv/src/lib/x11_dynam/ivx11_dynamlib.cpp
@@ -2,6 +2,15 @@ extern "C" {
 
 /* all X11 structures, declarations, etc. */
 #define XUTIL_DEFINE_FUNCTIONS
+
+#ifndef _X_DEPRECATED
+#  define _X_DEPRECATED
+#endif
+
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
+
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
 
diff --git a/external/iv/src/lib/x11_dynam/mkdynam.py b/external/iv/src/lib/x11_dynam/mkdynam.py
index d01f440..09fa864 100644
--- a/external/iv/src/lib/x11_dynam/mkdynam.py
+++ b/external/iv/src/lib/x11_dynam/mkdynam.py
@@ -123,6 +123,10 @@ def f_begin(prefix):
 /* automatically generated by mkdynam.py */
 #ifndef %s_h
 #define %s_h
+
+#ifndef _X_SENTINEL
+#  define _X_SENTINEL(x)
+#endif
 \n''' % (prefix, prefix))
     return f
 
-- 
2.30.2
